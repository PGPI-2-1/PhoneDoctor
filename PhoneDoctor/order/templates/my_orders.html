{% extends 'core/base.html' %}

{% block title %} Mis pedidos {% endblock %}

{% block content %}
<div class="grid grid-cols-3 gap-6">
    <div class="col-span-2">
        <div class="mt-6 px-6 py-12 rounded-xl">
            <div class="user-list">
                <h2 class="mb-8 text-2xl text-center">Mis pedidos</h2>
                <ul class="user-table">
                    {% for order in orders %}
                    <li class="user-item">
                        <div class="user-details">
                            <strong>Productos:</strong>
                            {% for item in order.items.all %}
                            <p>- {{ item.quantity }}x {{ item.product.name }}</p>
                            {% endfor %}
                        </div>
                        <div class="user-details">
                            <strong>Dirección:</strong> {{ order.address }}
                        </div>
                        <div class="user-details">
                            <strong>Correo electrónico:</strong> {{ order.email }}
                        </div>
                        <div class="user-details">
                            <strong>Precio total:</strong> {{ order.precio_total }}€
                        </div>
                        <div class="user-details">
                            <strong>Estado:</strong> {{ order.status|capfirst }}
                        </div>
                        <div class="user-details">
                            <strong>ID de seguimiento:</strong> {{ order.id_tracking }}
                        </div>
                        {% if not order.review %}
                        <div class="user-role">
                            <a class="staff-label" href="{% url 'order_review' order.id %}">Añadir opinión</a>
                        </div>
                        {% endif %}
                    </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>

    <div class="col-span-1 mt-4">
        <div class="mt-6 px-6 py-12 rounded-xl">
            <form action="search_order" method="get" class="flex items-center">
                <input type="text" name="q" placeholder="Buscar pedido" class="px-4 py-2 bg-gray-300 text-gray-800 placeholder-black focus:outline-none border-none rounded-l-md">
                <button type="submit" class="bg-blue-800 text-white px-4 py-2 focus:outline-none rounded-r-md">
                    <i class="fa fa-search"></i>
                </button>
            </form>
        </div>
    </div>
</div>

<style>
    body {
        font-family: 'Arial', sans-serif;
        background-color: #f5f5f5;
        margin: 0;
        padding: 0;
    }

    .user-list {
        max-width: 600px;
        margin: 20px auto;
        background-color: #fff;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        padding: 20px;
    }

    .fa-search {
        color: #fff;
        font-size: 1.2em;
    }

    .user-table {
        margin-top: 20px;
        /* Adjust the top margin to create space between header and table */
        padding: 0;
    }

    .user-item {
        list-style: none;
        border-bottom: 1px solid #ddd;
        padding: 10px 0;
    }

    .user-details {
        flex-grow: 1;
    }

    .user-role {
        text-align: right;
    }

    .staff-label,
    .user-label {
        font-weight: bold;
        padding: 4px 8px;
        border-radius: 4px;
        text-transform: uppercase;
    }

    .staff-label {
        color: rgb(255, 255, 255);
        /* Red for staff */
        background-color: #5e8cff;
        /* Light red background */
    }

    .user-label {
        color: #52c41a;
        /* Green for users */
        background-color: #e6f7ff;
        /* Light blue background */
    }
</style>

{% endblock %}